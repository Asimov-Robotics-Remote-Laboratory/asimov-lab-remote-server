import{p as De,aq as Ue,as as Me,at as Re,j as Ee,k as Pe,r as L,s as M,u as ue,w as x,av as Ae,ao as Te,aw as Be,aH as O,a3 as R,D as se,ax as Ne,z as Le,af as P,A as t,W as z,ay as Oe,B as K,az as Ke,aA as oe,aB as ze,X as ie,aC as je,aD as He,aE as qe,Y as E,aI as We,aF as Je,aJ as Xe,O as Ye,a5 as Ge,a6 as Qe,aK as Ze,a7 as X,a9 as $e,aa as S,ab as el,ac as ll,ad as al,aL as tl,_ as nl,a4 as ul,ae as sl,aM as ol,V as re}from"./index.d01dead9.js";import{m as il,b as rl,u as cl,c as dl,a as vl}from"./filter.585188f7.js";function fl(e,r,F){if(r==null)return e;if(Array.isArray(r))throw new Error("Multiple matches is not implemented");return typeof r=="number"&&~r?t(z,null,[t("span",{class:"v-combobox__unmask"},[e.substr(0,r)]),t("span",{class:"v-combobox__mask"},[e.substr(r,F)]),t("span",{class:"v-combobox__unmask"},[e.substr(r+F)])]):e}const ml=De({autoSelectFirst:{type:[Boolean,String]},delimiters:Array,...il({filterKeys:["title"]}),...rl({hideNoData:!0,returnObject:!0}),...Ue(Me({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Re({transition:!1})},"VCombobox"),hl=Ee()({name:"VCombobox",props:ml(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,r){var $,ee;let{emit:F,slots:u}=r;const{t:m}=Pe(),b=L(),v=M(!1),p=M(!0),A=M(!1),Y=L(),G=L(),j=ue(e,"menu"),c=x({get:()=>j.value,set:l=>{var n;j.value&&!l&&((n=Y.value)==null?void 0:n.\u03A8openChildren)||(j.value=l)}}),i=M(-1);let H=!1;const ce=x(()=>{var l;return(l=b.value)==null?void 0:l.color}),Q=x(()=>c.value?e.closeText:e.openText),{items:Z,transformIn:de,transformOut:ve}=Ae(e),{textColorClasses:fe,textColorStyles:me}=Te(ce),o=ue(e,"modelValue",[],l=>de(Ye(l)),l=>{var s;const n=ve(l);return e.multiple?n:(s=n[0])!=null?s:null}),I=Be(),_=M(e.multiple?"":(ee=($=o.value[0])==null?void 0:$.title)!=null?ee:""),f=x({get:()=>_.value,set:l=>{var n;if(_.value=l!=null?l:"",e.multiple||(o.value=[O(e,l)]),l&&e.multiple&&((n=e.delimiters)==null?void 0:n.length)){const s=l.split(new RegExp(`(?:${e.delimiters.join("|")})+`));s.length>1&&(s.forEach(g=>{g=g.trim(),g&&V(O(e,g))}),_.value="")}l||(i.value=-1),p.value=!l}}),he=x(()=>typeof e.counterValue=="function"?e.counterValue(o.value):typeof e.counterValue=="number"?e.counterValue:e.multiple?o.value.length:f.value.length);R(_,l=>{H?se(()=>H=!1):v.value&&!c.value&&(c.value=!0),F("update:search",l)}),R(o,l=>{var n,s;e.multiple||(_.value=(s=(n=l[0])==null?void 0:n.title)!=null?s:"")});const{filteredItems:D,getMatches:ge}=cl(e,Z,()=>p.value?"":f.value),C=x(()=>e.hideSelected?D.value.filter(l=>!o.value.some(n=>n.value===l.value)):D.value),be=x(()=>o.value.map(l=>l.value)),T=x(()=>{var n;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&f.value===((n=C.value[0])==null?void 0:n.title))&&C.value.length>0&&!p.value&&!A.value}),q=x(()=>e.hideNoData&&!Z.value.length||e.readonly||(I==null?void 0:I.isReadonly.value)),W=L(),{onListScroll:Ve,onListKeydown:ye}=dl(W,b);function xe(l){H=!0,e.openOnClear&&(c.value=!0)}function pe(){q.value||(c.value=!0)}function Ce(l){q.value||(v.value&&(l.preventDefault(),l.stopPropagation()),c.value=!c.value)}function ke(l){var g;if(Xe(l)||e.readonly||(I==null?void 0:I.isReadonly.value))return;const n=b.value.selectionStart,s=o.value.length;if((i.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(c.value=!0),["Escape"].includes(l.key)&&(c.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(T.value&&["Enter","Tab"].includes(l.key)&&V(D.value[0]),p.value=!0),l.key==="ArrowDown"&&T.value&&((g=W.value)==null||g.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(l.key)){if(i.value<0){l.key==="Backspace"&&!f.value&&(i.value=s-1);return}const a=i.value,d=o.value[i.value];d&&!d.props.disabled&&V(d,!1),i.value=a>=s-1?s-2:a}if(l.key==="ArrowLeft"){if(i.value<0&&n>0)return;const a=i.value>-1?i.value-1:s-1;o.value[a]?i.value=a:(i.value=-1,b.value.setSelectionRange(f.value.length,f.value.length))}if(l.key==="ArrowRight"){if(i.value<0)return;const a=i.value+1;o.value[a]?i.value=a:(i.value=-1,b.value.setSelectionRange(0,0))}l.key==="Enter"&&f.value&&(V(O(e,f.value)),f.value="")}}function we(){var l;v.value&&(p.value=!0,(l=b.value)==null||l.focus())}function V(l){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.multiple){const s=o.value.findIndex(a=>e.valueComparator(a.value,l.value)),g=n==null?!~s:n;if(~s){const a=g?[...o.value,l]:[...o.value];a.splice(s,1),o.value=a}else g&&(o.value=[...o.value,l]);f.value=""}else{const s=n!==!1;o.value=s?[l]:[],_.value=s?l.title:"",se(()=>{c.value=!1,p.value=!0})}}function Se(l){v.value=!0,setTimeout(()=>{A.value=!0})}function Ie(l){A.value=!1}function _e(l){(l==null||l===""&&!e.multiple)&&(o.value=[])}return R(D,l=>{!l.length&&e.hideNoData&&(c.value=!1)}),R(v,(l,n)=>{l||l===n||(i.value=-1,c.value=!1,T.value&&!A.value&&!o.value.some(s=>{let{value:g}=s;return g===C.value[0].value})?V(C.value[0]):e.multiple&&f.value&&V(O(e,f.value)))}),R(c,()=>{if(!e.hideSelected&&c.value&&o.value.length){const l=C.value.findIndex(n=>o.value.some(s=>e.valueComparator(s.value,n.value)));Ne&&window.requestAnimationFrame(()=>{var n;l>=0&&((n=G.value)==null||n.scrollToIndex(l))})}}),Le(()=>{const l=!!(e.chips||u.chip),n=!!(!e.hideNoData||C.value.length||u["prepend-item"]||u["append-item"]||u["no-data"]),s=o.value.length>0,g=P.filterProps(e);return t(P,K({ref:b},g,{modelValue:f.value,"onUpdate:modelValue":[a=>f.value=a,_e],focused:v.value,"onUpdate:focused":a=>v.value=a,validationValue:o.externalValue,counterValue:he.value,dirty:s,class:["v-combobox",{"v-combobox--active-menu":c.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!u.selection,"v-combobox--selecting-index":i.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:e.readonly,placeholder:s?void 0:e.placeholder,"onClick:clear":xe,"onMousedown:control":pe,onKeydown:ke}),{...u,default:()=>t(z,null,[t(Oe,K({ref:Y,modelValue:c.value,"onUpdate:modelValue":a=>c.value=a,activator:"parent",contentClass:"v-combobox__content",disabled:q.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:we},e.menuProps),{default:()=>{var a;return[n&&t(Ke,{ref:W,selected:be.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:d=>d.preventDefault(),onKeydown:ye,onFocusin:Se,onFocusout:Ie,onScrollPassive:Ve,tabindex:"-1",color:(a=e.itemColor)!=null?a:e.color},{default:()=>{var d,y,k,U;return[(d=u["prepend-item"])==null?void 0:d.call(u),!C.value.length&&!e.hideNoData&&((k=(y=u["no-data"])==null?void 0:y.call(u))!=null?k:t(oe,{title:m(e.noDataText)},null)),t(ze,{ref:G,renderless:!0,items:C.value},{default:w=>{var ae,te;let{item:h,index:J,itemRef:Fe}=w;const le=K(h.props,{ref:Fe,key:J,active:T.value&&J===0?!0:void 0,onClick:()=>V(h,null)});return(te=(ae=u.item)==null?void 0:ae.call(u,{item:h,index:J,props:le}))!=null?te:t(oe,le,{prepend:B=>{let{isSelected:N}=B;return t(z,null,[e.multiple&&!e.hideSelected?t(vl,{key:h.value,modelValue:N,ripple:!1,tabindex:"-1"},null):void 0,h.props.prependIcon&&t(ie,{icon:h.props.prependIcon},null)])},title:()=>{var B,N,ne;return p.value?h.title:fl(h.title,(B=ge(h))==null?void 0:B.title,(ne=(N=f.value)==null?void 0:N.length)!=null?ne:0)}})}}),(U=u["append-item"])==null?void 0:U.call(u)]}})]}}),o.value.map((a,d)=>{function y(h){h.stopPropagation(),h.preventDefault(),V(a,!1)}const k={"onClick:close":y,onMousedown(h){h.preventDefault(),h.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},U=l?!!u.chip:!!u.selection,w=U?je(l?u.chip({item:a,index:d,props:k}):u.selection({item:a,index:d})):void 0;if(!(U&&!w))return t("div",{key:a.value,class:["v-combobox__selection",d===i.value&&["v-combobox__selection--selected",fe.value]],style:d===i.value?me.value:{}},[l?u.chip?t(qe,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:a.title}}},{default:()=>[w]}):t(He,K({key:"chip",closable:e.closableChips,size:"small",text:a.title,disabled:a.props.disabled},k),null):w!=null?w:t("span",{class:"v-combobox__selection-text"},[a.title,e.multiple&&d<o.value.length-1&&t("span",{class:"v-combobox__selection-comma"},[E(",")])])])})]),"append-inner":function(){var k;for(var a=arguments.length,d=new Array(a),y=0;y<a;y++)d[y]=arguments[y];return t(z,null,[(k=u["append-inner"])==null?void 0:k.call(u,...d),(!e.hideNoData||e.items.length)&&e.menuIcon?t(ie,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:Ce,onClick:We,"aria-label":m(Q.value),title:m(Q.value)},null):void 0])}})}),Je({isFocused:v,isPristine:p,menu:c,search:f,selectionIndex:i,filteredItems:D,select:V},b)}}),gl={name:"UserForm",props:["id"],data(){return{notificationStore:Qe(),roles:["ADMINISTRATOR","USER"],title:this.id?"Editar Usu\xE1rio":"Novo Usu\xE1rio",loading:!1,user:new Ze}},mounted(){this.id&&this.findUserById()},methods:{async findUserById(){try{this.loading=!0;const e=this.id;this.user=await X.findUserById(e),this.user.id=this.user._id,this.loading=!1}catch(e){const r=e.data.errors;this.loading=!1,this.notificationStore.setErrorMessages(r),this.$router.push({name:"users"})}},async save(){if(this.loading=!0,this.user._id)try{await X.updateUser(this.user),this.$router.push({name:"users"}),this.loading=!1,this.notificationStore.setSuccessMessages([{msg:"Usu\xE1rio atualizado com sucesso!"}])}catch(e){this.loading=!1,this.notificationStore.setErrorMessages(e.data.errors)}else try{await X.createUser(this.user),this.$router.push({name:"users"}),this.loading=!1,this.notificationStore.setSuccessMessages([{msg:"Usu\xE1rio inserido com sucesso!"}])}catch(e){this.loading=!1,this.notificationStore.setErrorMessages(e.data.errors)}},cancel(){this.$router.push({name:"users"})}}};function bl(e,r,F,u,m,b){return ll(),$e("div",null,[t(el,{loading:m.loading,flat:""},{default:S(()=>[t(al,null,{default:S(()=>[E(" Usu\xE1rio ")]),_:1}),t(tl,null,{default:S(()=>[E(nl(m.title),1)]),_:1}),t(ul),t(sl,null,{default:S(()=>[t(ol,{ref:"form"},{default:S(()=>[t(P,{label:"Nome",type:"text",outlined:"",dense:"",modelValue:m.user.name,"onUpdate:modelValue":r[0]||(r[0]=v=>m.user.name=v)},null,8,["modelValue"]),t(P,{label:"E-mail",type:"text",outlined:"",dense:"",modelValue:m.user.email,"onUpdate:modelValue":r[1]||(r[1]=v=>m.user.email=v)},null,8,["modelValue"]),t(hl,{modelValue:m.user.role,"onUpdate:modelValue":r[2]||(r[2]=v=>m.user.role=v),items:m.roles,label:"Papel",dense:"",outlined:""},null,8,["modelValue","items"]),t(P,{label:"Senha",type:"password",outlined:"",dense:"",modelValue:m.user.password,"onUpdate:modelValue":r[3]||(r[3]=v=>m.user.password=v)},null,8,["modelValue"])]),_:1},512),t(re,{class:"ma-2",color:"success",dark:"",onClick:b.save},{default:S(()=>[E(" Salvar ")]),_:1},8,["onClick"]),t(re,{class:"ma-2",color:"red",dark:"",onClick:b.cancel},{default:S(()=>[E(" Cancelar ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["loading"])])}const xl=Ge(gl,[["render",bl]]);export{xl as default};
